# コンテクストマップ生成ツール

PowerPointのテンプレートを使用して、企業のコンテクストマップを自動生成するPythonツールです。

## 概要

このツールは、JSONデータを読み込み、PowerPointテンプレート内のプレースホルダーを企業情報で置換して、見やすいコンテクストマップを生成します。

## ディレクトリ構成

```
.
├── context_map_generator.py  # メインプログラム
├── template.pptx            # PowerPointテンプレート
├── data.json               # 入力データ（JSON形式）
├── generated_context_map.pptx  # 出力ファイル
└── README.md               # このファイル
```

## 必要な環境

- Python 3.6以上
- python-pptx ライブラリ

## インストール

```bash
pip install python-pptx
```

## 使用方法

1. JSONデータファイル（`data.json`）を準備します
2. PowerPointテンプレート（`template.pptx`）が同じディレクトリにあることを確認します
3. プログラムを実行します：

```bash
python context_map_generator.py
```

4. 企業名を入力するよう求められるので、入力してEnterを押します
5. `generated_context_map.pptx`という名前で出力ファイルが生成されます

## 入力データ形式

`data.json`は以下の形式で準備してください：

```json
[
  {
    "code": "A",
    "section_name": "企業戦略文脈",
    "items": [
      {
        "title": "PR業界世界No.1へのビジョン展開",
        "url": "https://..."
      },
      // ... 最大5項目
    ],
    "social_trend": [
      "DX推進による事業変革",
      "グローバル市場での存在感向上",
      "技術革新への積極投資"
    ]
  },
  // ... 他の4セクション
]
```

## テンプレートの構造

テンプレートは以下の要素を含む必要があります：

### 中央のノード
- `企業名` - 企業名が入る中央の円

### 5つの主要セクション（円形ノード）
- `企業` - 企業戦略文脈（A）
- `プロ` - プロダクト文脈（B）  
- `TOP` - TOP文脈（C）
- `業界` - 業界トレンド文脈（D）
- `グロ` - グローバル文脈（E）

### 各セクションの項目（四角形ノード）
各セクションには5つのプレースホルダーがあります：
- Aセクション：`あ`、`い`、`う`、`え`、`お`
- Bセクション：`か`、`き`、`く`、`け`、`こ`
- Cセクション：`さ`、`し`、`す`、`せ`、`そ`
- Dセクション：`た`、`ち`、`つ`、`て`、`と`
- Eセクション：`な`、`に`、`ぬ`、`ね`、`の`

### ソーシャルトレンド（外側の円形ノード）
各セクションには3つのソーシャルトレンドがあります：
- Aセクション：`一`、`二`、`三`
- Bセクション：`十`、`十一`、`十二`
- Cセクション：`四`、`五`、`六`
- Dセクション：`十三`、`十四`、`十五`
- Eセクション：`七`、`八`、`九`

### その他
- `企業名コンテクストマップ` - 左上のタイトル

## プログラムの特徴

- **自動テキスト調整**: 長いテキストは自動的に改行され、ボックスに収まるように調整されます
- **フォントサイズ最適化**: テキストの長さに応じてフォントサイズが動的に調整されます
- **見やすさの維持**: 最小フォントサイズを制限し、読みやすさを保ちます
- **スマートな改行**: 日本語の自然な区切りで改行を入れます

## 注意事項

- テンプレートのプレースホルダーは完全一致である必要があります
- JSONデータのセクションコード（A〜E）は固定です
- 各セクションのアイテムは最大5個、ソーシャルトレンドは最大3個まで対応しています
- 生成されたファイルは既存のファイルを上書きします

## トラブルシューティング

### テキストがはみ出す場合
プログラムは自動的にテキストを調整しますが、極端に長いテキストの場合は手動で編集が必要な場合があります。

### フォントが小さすぎる場合
プログラム内の`adjust_font_size`関数の最小フォントサイズを調整できます。

### エラーが発生した場合
- ファイルパスが正しいか確認してください
- JSONデータの形式が正しいか確認してください
- python-pptxがインストールされているか確認してください

## ライセンス

このプロジェクトはMITライセンスで公開されています。
